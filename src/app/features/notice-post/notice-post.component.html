<div class="post-container">
  <div class="post-card">
    <div class="post-header">
      <h3>üìù Create New Notice</h3>
      <p>Share important information with your audience</p>
    </div>

    <form>
      <div class="form-group">
        <label>Title *</label>
        <input class="form-input" [(ngModel)]="notice.title" name="title" placeholder="Enter notice title" />
      </div>

      <div class="form-group">
        <label>Description *</label>
        <textarea class="form-textarea" [(ngModel)]="notice.description" name="description"
          placeholder="Provide detailed information about the notice"></textarea>
      </div>

      <div class="form-row">
        <!-- Department Dropdown -->
        <div class="form-group">
          <label>Department *</label>
          <div class="custom-dropdown" (click)="toggleDepartmentDropdown()">
            <span>{{ notice.department || 'Select Department' }}</span>
            <ul *ngIf="departmentDropdownOpen" class="dropdown-list">
              <li *ngFor="let dept of departments" (click)="selectDepartment(dept, $event)">
                {{ dept.name }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Year Dropdown -->
        <div class="form-group">
          <label>Year *</label>
          <div class="custom-dropdown" (click)="toggleYearDropdown()">
            <span>
              {{ notice.year !== null && notice.year !== undefined ? getYearLabel(notice.year) : 'Select Year' }}
            </span>
            <ul *ngIf="yearDropdownOpen" class="dropdown-list">
              <li *ngFor="let yr of years" (click)="selectYear(yr, $event)">
                {{ yr.yearName }}
              </li>
            </ul>
          </div>
        </div>

      </div>

      <div class="form-group">
        <label>Expiry Date *</label>
        <input type="date" class="form-input" [(ngModel)]="notice.expiryDate" name="expiryDate" [min]="today" />
      </div>

      <div class="file-upload-wrapper">
        <label class="file-upload-label">
          <span class="upload-icon">üìé</span>
          <span>Click to upload images</span>
          <input type="file" class="file-upload-input" (change)="onFilesSelected($event)" multiple
            accept="image/*, application/pdf" />
        </label>
      </div>

      <div *ngIf="previewUrls.length > 0" class="preview-section">
        <h4 class="preview-header">Image Preview</h4>
        <div class="preview-grid">
          <div *ngFor="let file of selectedFiles; let i = index" class="preview-item">

            <!-- Image Preview -->
            <img *ngIf="file.type.startsWith('image/')" [src]="previewUrls[i]" class="preview-image">

            <!-- PDF Preview -->
            <div *ngIf="file.type === 'application/pdf'" class="pdf-preview-box" (click)="openPDF(previewUrls[i])">
              <img src="assets/PDF.png" class="pdf-icon" />
            </div>
            
            <button type="button" (click)="removeImage(i)" class="remove-btn">‚úï</button>
          </div>

        </div>
      </div>

      <button type="button" class="submit-btn" (click)="postNotice()">
        üöÄ Post Notice
      </button>

      <p *ngIf="success" class="success-message">{{ success }}</p>
      <p *ngIf="error" class="error-message">{{ error }}</p>
    </form>
  </div>
</div>