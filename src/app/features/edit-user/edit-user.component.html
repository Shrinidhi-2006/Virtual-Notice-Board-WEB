<div class="edit-user-container">
  <div class="page-header">
    <h3>‚úèÔ∏è Edit User</h3>
    <p>Modify user details and update their information</p>
  </div>

  <div class="form-card">
    <form (ngSubmit)="updateUser()">
      <div class="form-grid">
        <div class="form-group">
          <label>Username *</label>
          <input class="form-input readonly" [(ngModel)]="user.username" name="username" readonly />
          <small class="input-hint">Username cannot be changed</small>
        </div>

        <div class="form-group">
          <label>Full Name *</label>
          <input class="form-input" [(ngModel)]="user.name" name="name" placeholder="Enter full name" />
        </div>

        <div class="form-group">
          <label>Email *</label>
          <input class="form-input" [(ngModel)]="user.gmail" name="gmail" type="email" placeholder="user@example.com" />
        </div>

        <div class="form-group">
          <label>Mobile Number *</label>
          <input class="form-input" [(ngModel)]="user.mobileNumber" name="mobileNumber"
            placeholder="Enter mobile number" />
        </div>

        <div class="form-group">
          <label>Date of Birth *</label>
          <input class="form-input" type="date" [(ngModel)]="user.dateOfBirth" name="dateOfBirth" />
        </div>

        <!-- Custom Role Dropdown -->
        <div class="form-group">
          <label>Role *</label>
          <div class="custom-dropdown" (click)="toggleRoleDropdown()">
            <span>{{ selectedRole || 'Select Role' }}</span>
            <ul *ngIf="roleDropdownOpen" class="dropdown-list">
              <li *ngFor="let r of roles" (click)="selectRole(r, $event)">
                {{ r.name }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Custom Department Dropdown -->
        <div class="form-group">
          <label [class.disabled-label]="isRoleRestricted()">Department *</label>
          <div class="custom-dropdown" [class.disabled]="isRoleRestricted()"
            (click)="!isRoleRestricted() && toggleDepartmentDropdown()">
            <span>{{ selectedDepartment || 'Select Department' }}</span>
            <ul *ngIf="departmentDropdownOpen && !isRoleRestricted()" class="dropdown-list">
              <li *ngFor="let dept of departments" (click)="selectDepartment(dept, $event)">
                {{ dept.name }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Custom Year Dropdown -->
        <div class="form-group">
          <label [class.disabled-label]="isRoleRestricted()">Year *</label>
          <div class="custom-dropdown" [class.disabled]="isRoleRestricted()"
            (click)="!isRoleRestricted() && toggleYearDropdown()">
            <span>{{ selectedYearName || 'Select Year' }}</span>
            <ul *ngIf="yearDropdownOpen && !isRoleRestricted()" class="dropdown-list">
              <li *ngFor="let y of years" (click)="selectYear(y, $event)">
                {{ y.yearName }}
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="save-btn">üíæ Save Changes</button>
        <button type="button" class="cancel-btn" (click)="router.navigate(['/app/manage-users'])">
          ‚ùå Cancel
        </button>
      </div>

      <p *ngIf="success" class="success-message">{{ success }}</p>
      <p *ngIf="error" class="error-message">{{ error }}</p>
    </form>
  </div>
</div>